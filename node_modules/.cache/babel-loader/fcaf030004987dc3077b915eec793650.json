{"ast":null,"code":"import _objectSpread from \"/home/smp/workspace/practice-project/react-graphql-github-apollo-starter-kit/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _taggedTemplateLiteral from \"/home/smp/workspace/practice-project/react-graphql-github-apollo-starter-kit/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/home/smp/workspace/practice-project/react-graphql-github-apollo-starter-kit/src/Repository/RepositoryItem/index.js\";\n\nfunction _templateObject4() {\n  var data = _taggedTemplateLiteral([\"\\n  mutation($id: ID!) {\\n    updateSubscription(input: { subscribableId: $id, state: UNSUBSCRIBED }) {\\n      subscribable {\\n        id\\n        viewerSubscription\\n      }\\n    }\\n  }\\n\"]);\n\n  _templateObject4 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteral([\"\\n  mutation($id: ID!) {\\n    updateSubscription(input: { subscribableId: $id, state: SUBSCRIBED }) {\\n      subscribable {\\n        id\\n        viewerSubscription\\n      }\\n    }\\n  }\\n\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n  mutation($id: ID!) {\\n    removeStar(input: { starrableId: $id }) {\\n      starrable {\\n        id\\n        viewerHasStarred\\n      }\\n    }\\n  }\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  mutation($id: ID!) {\\n    addStar(input: { starrableId: $id }) {\\n      starrable {\\n        id\\n        viewerHasStarred\\n      }\\n    }\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React from 'react';\nimport gql from 'graphql-tag';\nimport { Mutation } from 'react-apollo';\nimport REPOSITORY_FRAGMENT from '../fragments';\nimport Link from '../../Link';\nimport Button from '../../Button';\nimport '../style.css';\nvar STAR_REPOSITORY = gql(_templateObject());\nvar UNSTAR_REPOSITORY = gql(_templateObject2());\nvar WATCH_REPOSITORY = gql(_templateObject3());\nvar UNWATCH_REPOSITORY = gql(_templateObject4());\n\nvar updateAddStar = function updateAddStar(client, _ref) {\n  var id = _ref.data.addStar.starrable.id;\n  var repository = client.readFragment({\n    id: \"Repository:\".concat(id),\n    fragment: REPOSITORY_FRAGMENT\n  });\n  var totalCount = repository.stargazers.totalCount + 1;\n  client.writeFragment({\n    id: \"Repository:\".concat(id),\n    fragment: REPOSITORY_FRAGMENT,\n    data: _objectSpread({}, repository, {\n      stargazers: _objectSpread({}, repository.stargazers, {\n        totalCount: totalCount\n      })\n    })\n  });\n};\n\nvar updateWatch = function updateWatch(client, _ref2) {\n  var _ref2$data$updateSubs = _ref2.data.updateSubscription.subscribable,\n      id = _ref2$data$updateSubs.id,\n      viewerSubscription = _ref2$data$updateSubs.viewerSubscription;\n  var repository = client.readFragment({\n    id: \"Repository:\".concat(id),\n    fragment: REPOSITORY_FRAGMENT\n  });\n  var watchers = repository.watchers.totalCount + 1;\n  clilent.writeFragment({\n    id: \"Repository:\".concat(id),\n    fragment: REPOSITORY_FRAGMENT,\n    data: _objectSpread({}, repository, {\n      watchers: _objectSpread({}, repository.watchers, {\n        totalCount: totalCount\n      })\n    })\n  });\n};\n\nvar updateRemoveStar = function updateRemoveStar(client, _ref3) {\n  var id = _ref3.data.removeStar.starrable.id;\n  console.log(\"id\", id);\n  var repository = client.readFragment({\n    id: \"Repository:\".concat(id),\n    fragment: REPOSITORY_FRAGMENT\n  });\n  var totalCount = repository.stargazers.totalCount - 1;\n  client.writeFragment({\n    id: \"Repository:\".concat(id),\n    fragment: REPOSITORY_FRAGMENT,\n    data: _objectSpread({}, repository, {\n      stargazers: _objectSpread({}, repository.stargazers, {\n        totalCount: totalCount\n      })\n    })\n  });\n};\n\nvar RepositoryItem = function RepositoryItem(_ref4) {\n  var id = _ref4.id,\n      name = _ref4.name,\n      url = _ref4.url,\n      descriptionHTML = _ref4.descriptionHTML,\n      primaryLanguage = _ref4.primaryLanguage,\n      owner = _ref4.owner,\n      stargazers = _ref4.stargazers,\n      watchers = _ref4.watchers,\n      viewerSubscription = _ref4.viewerSubscription,\n      viewerHasStarred = _ref4.viewerHasStarred;\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"RepositoryItem-title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143\n    },\n    __self: this\n  }, React.createElement(\"h2\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144\n    },\n    __self: this\n  }, React.createElement(Link, {\n    href: url,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145\n    },\n    __self: this\n  }, name)), React.createElement(\"div\", {\n    className: \"RepositoryItem-title-action\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148\n    },\n    __self: this\n  }, stargazers.totalCount, \" Stars\")), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153\n    },\n    __self: this\n  }, !viewerHasStarred ? React.createElement(Mutation, {\n    mutation: STAR_REPOSITORY,\n    variables: {\n      id: id\n    },\n    update: updateAddStar,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155\n    },\n    __self: this\n  }, function (addStar, _ref5) {\n    var data = _ref5.data,\n        loading = _ref5.loading,\n        error = _ref5.error;\n    return React.createElement(Button, {\n      className: 'RepositoryItem-title-action',\n      onClick: addStar,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161\n      },\n      __self: this\n    }, stargazers.totalCount, \" Star\");\n  }) : React.createElement(Mutation, {\n    mutation: UNSTAR_REPOSITORY,\n    variables: {\n      id: id\n    },\n    update: updateRemoveStar,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170\n    },\n    __self: this\n  }, function (removeStar, _ref6) {\n    var data = _ref6.data,\n        loading = _ref6.loading,\n        error = _ref6.error;\n    return React.createElement(Button, {\n      className: 'RepositoryItem-title-action',\n      onClick: removeStar,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176\n      },\n      __self: this\n    }, stargazers.totalCount, \" Unstar\");\n  })), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187\n    },\n    __self: this\n  }, console.log(id, name, viewerSubscription), viewerSubscription === \"UNSUBSCRIBED\" ? React.createElement(Mutation, {\n    mutation: WATCH_REPOSITORY,\n    variables: {\n      id: id\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192\n    },\n    __self: this\n  }, function (updateSubscription, _ref7) {\n    var data = _ref7.data,\n        loading = _ref7.loading,\n        error = _ref7.error;\n    return React.createElement(Button, {\n      className: 'RepositoryItem-title-action',\n      onClick: updateSubscription,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    }, watchers.totalCount, \" Watch\");\n  }) : React.createElement(Mutation, {\n    mutation: UNWATCH_REPOSITORY,\n    variables: {\n      id: id\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203\n    },\n    __self: this\n  }, function (updateSubscription, _ref8) {\n    var data = _ref8.data,\n        loading = _ref8.loading,\n        error = _ref8.error;\n    return React.createElement(Button, {\n      className: 'RepositoryItem-title-action',\n      onClick: updateSubscription,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205\n      },\n      __self: this\n    }, watchers.totalCount, \" Unwatch\");\n  })), React.createElement(\"div\", {\n    className: \"RepositoryItem-description\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"RepositoryItem-description-info\",\n    dangerouslySetInnerHTML: {\n      __html: descriptionHTML\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"RepositoryItem-description-details\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222\n    },\n    __self: this\n  }, primaryLanguage && React.createElement(\"span\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224\n    },\n    __self: this\n  }, \"Language: \", primaryLanguage.name)), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227\n    },\n    __self: this\n  }, owner && React.createElement(\"span\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229\n    },\n    __self: this\n  }, \"Owner: \", React.createElement(\"a\", {\n    href: owner.url,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230\n    },\n    __self: this\n  }, owner.login))))));\n};\n\nexport default RepositoryItem;","map":{"version":3,"sources":["/home/smp/workspace/practice-project/react-graphql-github-apollo-starter-kit/src/Repository/RepositoryItem/index.js"],"names":["React","gql","Mutation","REPOSITORY_FRAGMENT","Link","Button","STAR_REPOSITORY","UNSTAR_REPOSITORY","WATCH_REPOSITORY","UNWATCH_REPOSITORY","updateAddStar","client","id","data","addStar","starrable","repository","readFragment","fragment","totalCount","stargazers","writeFragment","updateWatch","updateSubscription","subscribable","viewerSubscription","watchers","clilent","updateRemoveStar","removeStar","console","log","RepositoryItem","name","url","descriptionHTML","primaryLanguage","owner","viewerHasStarred","loading","error","__html","login"],"mappings":"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","sourcesContent":["import React from 'react'\nimport gql from 'graphql-tag'\nimport { Mutation } from 'react-apollo'\n\nimport REPOSITORY_FRAGMENT from '../fragments'\nimport Link from '../../Link'\nimport Button from '../../Button'\n\nimport '../style.css';\n\nconst STAR_REPOSITORY = gql`\n  mutation($id: ID!) {\n    addStar(input: { starrableId: $id }) {\n      starrable {\n        id\n        viewerHasStarred\n      }\n    }\n  }\n`\n\nconst UNSTAR_REPOSITORY = gql`\n  mutation($id: ID!) {\n    removeStar(input: { starrableId: $id }) {\n      starrable {\n        id\n        viewerHasStarred\n      }\n    }\n  }\n`\n\nconst WATCH_REPOSITORY = gql`\n  mutation($id: ID!) {\n    updateSubscription(input: { subscribableId: $id, state: SUBSCRIBED }) {\n      subscribable {\n        id\n        viewerSubscription\n      }\n    }\n  }\n`\n\nconst UNWATCH_REPOSITORY = gql`\n  mutation($id: ID!) {\n    updateSubscription(input: { subscribableId: $id, state: UNSUBSCRIBED }) {\n      subscribable {\n        id\n        viewerSubscription\n      }\n    }\n  }\n`\n\nconst updateAddStar = (\n  client, \n  { data: { addStar: { starrable: { id } } } },\n) => {\n  const repository = client.readFragment({\n    id: `Repository:${id}`,\n    fragment: REPOSITORY_FRAGMENT,\n  })\n\n  const totalCount = repository.stargazers.totalCount + 1\n\n  client.writeFragment({\n    id: `Repository:${id}`,\n    fragment: REPOSITORY_FRAGMENT,\n    data: {\n      ...repository,\n      stargazers: {\n        ...repository.stargazers,\n        totalCount,\n      },\n    },\n  })\n}\n\nconst updateWatch = (\n  client,\n  { data: { updateSubscription: { subscribable: { id, viewerSubscription } } } }\n) => {\n  const repository = client.readFragment({\n    id: `Repository:${id}`,\n    fragment: REPOSITORY_FRAGMENT,\n  })\n\n  const watchers = repository.watchers.totalCount + 1\n\n  clilent.writeFragment({\n    id: `Repository:${id}`,\n    fragment: REPOSITORY_FRAGMENT,\n    data: {\n      ...repository,\n      watchers: {\n        ...repository.watchers,\n        totalCount\n      },\n    },\n  })\n}\n\nconst updateRemoveStar = (\n  client, \n  { data: { removeStar: { starrable: { id } } } },\n) => {\n\n  console.log(\"id\",id)\n\n  const repository = client.readFragment({\n    id: `Repository:${id}`,\n    fragment: REPOSITORY_FRAGMENT,\n  })\n\n  const totalCount = repository.stargazers.totalCount - 1\n\n  client.writeFragment({\n    id: `Repository:${id}`,\n    fragment: REPOSITORY_FRAGMENT,\n    data: {\n      ...repository,\n      stargazers: {\n        ...repository.stargazers,\n        totalCount,\n      },\n    },\n  })\n}\n\nconst RepositoryItem = ({\n  id,\n  name,\n  url,\n  descriptionHTML,\n  primaryLanguage,\n  owner,\n  stargazers,\n  watchers,\n  viewerSubscription,\n  viewerHasStarred,\n}) => (\n  <div>\n    <div className=\"RepositoryItem-title\">\n      <h2>\n        <Link href={url}>{name}</Link>\n      </h2>\n\n      <div className=\"RepositoryItem-title-action\">\n        {stargazers.totalCount} Stars\n      </div>\n    </div>\n\n    <div>\n      {!viewerHasStarred ? (\n        <Mutation \n          mutation={STAR_REPOSITORY} \n          variables={{ id }}\n          update={updateAddStar}\n        >\n          {(addStar, { data, loading, error }) => (\n            <Button\n              className={'RepositoryItem-title-action'}\n              onClick={addStar}\n            >\n              {stargazers.totalCount} Star\n            </Button>\n          )}\n        </Mutation>\n      ) : ( \n        <Mutation \n          mutation={UNSTAR_REPOSITORY} \n          variables={{ id }}\n          update={updateRemoveStar}\n        >\n          {(removeStar, { data, loading, error }) => (\n            <Button\n              className={'RepositoryItem-title-action'}\n              onClick={removeStar}\n            >\n              {stargazers.totalCount} Unstar\n            </Button>\n          )}\n        </Mutation>\n      )}\n    </div>\n    \n    <div>\n      {\n        console.log(id, name, viewerSubscription)\n      }\n      {viewerSubscription === \"UNSUBSCRIBED\" ? ( \n        <Mutation mutation={WATCH_REPOSITORY} variables={{ id }}>\n          {(updateSubscription, { data, loading, error }) => (\n            <Button\n              className={'RepositoryItem-title-action'}\n              onClick={updateSubscription}\n            >\n              {watchers.totalCount} Watch\n            </Button>\n          )}\n        </Mutation>\n      ) : (\n        <Mutation mutation={UNWATCH_REPOSITORY} variables={{ id }}>\n          {(updateSubscription, { data, loading, error }) => (\n            <Button\n              className={'RepositoryItem-title-action'}\n              onClick={updateSubscription}\n            >\n              {watchers.totalCount} Unwatch\n            </Button>\n          )}\n        </Mutation>\n      )}\n    </div>\n\n    <div className=\"RepositoryItem-description\">\n      <div\n        className=\"RepositoryItem-description-info\"\n        dangerouslySetInnerHTML={{ __html: descriptionHTML }}\n      />\n      <div className=\"RepositoryItem-description-details\">\n        <div>\n          {primaryLanguage && (\n            <span>Language: {primaryLanguage.name}</span>\n          )}\n        </div>\n        <div>\n          {owner && (\n            <span>\n              Owner: <a href={owner.url}>{owner.login}</a>\n            </span>\n          )}\n        </div>\n      </div>\n    </div>\n  </div>\n);\n\nexport default RepositoryItem"]},"metadata":{},"sourceType":"module"}